#!/usr/bin/env python3
# SPDX-License-Identifier: LGPL-3.0-or-later
# Copyright (c) 2021 Intel Corporation
#                    Borys Pop≈Çawski <borysp@invisiblethingslab.com>

import click

from graminelibos import Sigstruct, get_token

@click.command()
@click.option('--sig', '-s', type=click.File('rb'), required=True, help='sigstruct file')
@click.option('--output', '-o', type=click.File('wb'), required=True, help='Output token file')
@click.option('--quiet', '-q', is_flag=True, help='Don\'t display details')
def main(sig, output, quiet):
    sig = Sigstruct.from_bytes(sig.read())
    token = get_token(sig, verbose=not quiet)
    output.write(token)

if __name__ == '__main__':
    main() # pylint: disable=no-value-for-parameter
